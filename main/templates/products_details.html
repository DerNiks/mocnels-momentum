{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block meta %}
<title>{{ product.name }} - Mocnels Momentum</title>
{% endblock meta %}

{% block content %}
<div class="max-w-7xl mx-auto px-6 lg:px-8 py-8 ">
  <!-- Back -->
  <a href="{% url 'main:show_main' %}" class="text-gray-600 hover:text-gray-900 font-medium">← Back Home</a>

  <div class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-10">
    <!-- LEFT: Image -->
    <section>
      <div class="aspect-square w-full overflow-hidden rounded-xl border border-gray-200 bg-white">
        <img src="{{ product.thumbnail }}" alt="{{ product.name }}"
             class="w-full h-full object-cover">
      </div>
    </section>

    <!-- RIGHT: Details -->
    <section class="product-detail">
      <!-- Badges -->
      <div class="flex flex-wrap items-center gap-2 mb-3">
        {% if product.category %}
          <span class="px-3 py-1 rounded-md text-xs font-medium bg-green-600 text-white">
            {{ product.get_category_display|default:product.category }}
          </span>
        {% endif %}
        {% if product.brand %}
          <span class="px-3 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700">
            {{ product.brand }}
          </span>
        {% endif %}
        {% if product.is_featured %}
          <span class="px-3 py-1 rounded-md text-xs font-medium bg-yellow-100 text-yellow-800">Featured</span>
        {% endif %}
      </div>

      <!-- Title -->
      <h1 class="text-3xl font-bold text-gray-900">
        {{ product.name }}
      </h1>

      <!-- dummy rating dan tanggl -->
      <div class="mt-2 flex flex-wrap items-center gap-3 text-sm text-gray-500">
        <span class="flex items-center gap-1 text-yellow-500">★ ★ ★ ★ ☆</span>
        <span>4.5 • 123 reviews</span>
        {% if product.created_at %}<span>• {{ product.created_at|date:"M j, Y" }}</span>{% endif %}
      </div>

      <!-- Price + stock -->
      <div class="mt-5">
        {% if product.price %}
          <div class="text-3xl font-semibold">Rp {{ product.price|intcomma }}</div>
        {% endif %}
        {% if product.stock is not None %}
          <div class="mt-1 text-sm {% if product.stock|default:0 > 0 %}text-green-600{% else %}text-red-600{% endif %}">
            {% if product.stock|default:0 > 0 %}In stock ({{ product.stock }}){% else %}Out of stock{% endif %}
          </div>
        {% endif %}
      </div>

      <!-- Short description -->
      <div class="mt-6 text-gray-700 whitespace-pre-line">
        {{ product.description }}
      </div>

      <!-- Options (dummy) -->
      <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-2">Quantity</label>
          <input type="number" min="1" value="1"
                 class="w-24 rounded-lg border border-gray-300 bg-white py-2 px-3">
        </div>
      </div>

      <!-- Dummy -->
      <div class="mt-6 flex flex-wrap gap-3">
        <button type="button" class="px-6 py-3 rounded-lg bg-green-600 text-white font-semibold hover:bg-green-700">
          Add to cart
        </button>
        <button type="button" class="px-6 py-3 rounded-lg bg-gray-900 text-white font-semibold hover:bg-black/80">
          Buy now
        </button>
        <button type="button" class="px-4 py-3 rounded-lg border border-gray-300 bg-white text-gray-800">
          Wishlist
        </button>
        <button type="button" id="shareBtn" class="px-4 py-3 rounded-lg border border-gray-300 bg-white text-gray-800">
          Share
        </button>
        <span id="shareMsg" class="text-sm text-gray-500 hidden">Link copied!</span>
      </div>

      <!-- Extra info -->
      <div class="mt-6 text-sm text-gray-500 space-y-1">
        <div>Free shipping over Rp 500.000 • 7-day returns</div>
        {% if product.user %}<div>Sold by <strong>{{ product.user.username }}</strong></div>{% endif %}
      </div>
    </section>
  </div>
</div>

<!-- tiny JS for Share (dummy) -->
<script>
(function(){
  const btn = document.getElementById('shareBtn');
  const msg = document.getElementById('shareMsg');
  if(!btn) return;
  btn.addEventListener('click', async () => {
    try {
      await navigator.clipboard.writeText(window.location.href);
      msg.classList.remove('hidden');
      setTimeout(()=>msg.classList.add('hidden'), 1500);
    } catch(e) {}
  });
})();
</script>
{% endblock content %}
